[                                                  
  {     
    "Control":"Guardrails1",
    "ModuleName": "Check-ProcedureDocument",
    "ModuleType": "Builtin",
    "Script": "Check-ProcedureDocument -StorageAccountName $vars.storageaccountname -ContainerName $vars.container -ResourceGroupName $ResourceGroupName -SubscriptionID $SubID -DocumentName \"Break Glass account Procedure\" -ControlName $CtrName1 -ItemName $vars.ItemName -LogType $LogType -WorkSpaceID  $WorkSpaceID -WorkspaceKey $WorkspaceKey -ReportTime $ReportTime",
    "variables":
    [
      {
        "Name":"container",
        "Value": "ContainerName"
      }
    ],
    "localVariables":
    [
      {
        "Name":"DocumentName",
        "Value": "BreakGlassAccountProcedure.txt"
      }
    ]
  }, 
  {
    "Control":"Guardrails1",
    "ModuleName": "Get-BreakGlassAccounts",
    "Script": "Get-BreakGlassAccounts -token $GraphAccessToken  -ControlName $CtrName1 -ItemName \"Break Glass account Creation\" -FirstBreakGlassUPN $vars.FirstBreakGlassUPN -SecondBreakGlassUPN $vars.SecondBreakGlassUPN     -LogType $LogType -WorkSpaceID  $WorkSpaceID -WorkspaceKey $WorkspaceKey -ReportTime $ReportTime ",
    "secrets":
    [
      {
        "Name":"FirstBreakGlassUPN",
        "Value":"BGA1"
      },
      {
        "Name":"SecondBreakGlassUPN",
        "Value": "BGA2"
      }
    ]
  },
  {
    "Control":"Guardrails1",
    "ModuleName": "Get-ADLicenseType",
    "Script": "Get-ADLicenseType -Token $GraphAccessToken -ControlName $CtrName1 -ItemName \"AD License Type\" -LogType $LogType -WorkSpaceID $WorkSpaceID -WorkspaceKey $WorkspaceKey -ReportTime $ReportTime"
  },
  {
    "Control":"Guardrails1",
    "ModuleName": "Get-UserAuthenticationMethod",
    "Script": "Get-UserAuthenticationMethod -token $GraphAccessToken -ControlName $CtrName1 -ItemName \"MFA Enforcement\" -FirstBreakGlassEmail $vars.FirstBreakGlassUPN -SecondBreakGlassEmail $vars.SecondBreakGlassUPN -LogType $LogType -WorkSpaceID $WorkSpaceID -WorkspaceKey $WorkspaceKey -ReportTime $ReportTime ",
    "secrets":
     [
      {
        "Name":"FirstBreakGlassUPN",
        "Value":"BGA1"
      },
      {
        "Name":"SecondBreakGlassUPN",
        "Value": "BGA2"
      }
     ]
  },
  {
    "Control":"Guardrails1",
     "ModuleName": "Get-BreakGlassAccountLicense",
     "Script": "Get-BreakGlassAccountLicense -token $GraphAccessToken -ControlName $CtrName1 -ItemName \"Microsoft 365 E5 Assignment\" -FirstBreakGlassUPN $vars.FirstBreakGlassUPN -SecondBreakGlassUPN $vars.SecondBreakGlassUPN -LogType $LogType -WorkSpaceID $WorkSpaceID -WorkspaceKey $WorkspaceKey -ReportTime $ReportTime",
     "secrets":
     [
      {
        "Name":"FirstBreakGlassUPN",
        "Value":"BGA1"
      },
      {
        "Name":"SecondBreakGlassUPN",
        "Value": "BGA2"
      }
     ]
  },
  {
    "Control":"Guardrails1",
     "ModuleName": "Get-BreakGlassOwnerinformation",
     "Script": "Get-BreakGlassOwnerinformation -token $GraphAccessToken -ControlName $CtrName1 -ItemName \"Break Glass Account Owners Contact information\" -FirstBreakGlassUPNOwner $vars.FirstBreakGlassUPN -SecondBreakGlassUPNOwner $vars.SecondBreakGlassUPN  -LogType $LogType -WorkSpaceID $WorkSpaceID -WorkspaceKey $WorkspaceKey -ReportTime $ReportTime",
     "secrets":
     [
      {
        "Name":"FirstBreakGlassUPN",
        "Value":"BGA1"
      },
      {
        "Name":"SecondBreakGlassUPN",
        "Value": "BGA2"
      }
     ]
  },{
    "Control":"Guardrails2",
     "ModuleName": "Check-ADDeletedUsers",
     "Script": "Check-ADDeletedUsers -Token $GraphAccessToken -ControlName $CtrName2 -ItemName \"Remove deprecated accounts\"      -LogType $LogType -WorkSpaceID $WorkSpaceID -WorkspaceKey $WorkspaceKey -ReportTime $ReportTime"
  },
  {
     "ModuleName": "Check-ExternalUsers",
     "Script": "Check-ExternalUsers -Token $GraphAccessToken -ControlName $CtrName2 -ItemName \"Remove External accounts\" -LogType $LogType -WorkSpaceID $WorkSpaceID -WorkspaceKey $WorkspaceKey -ReportTime $ReportTime"
  },
  {
     "ModuleName": "",
     "Script": "Check-MonitorAccountCreation -Token $GraphAccessToken -DepartmentNumner $vars.departmentnumber -ControlName $CtrName4 -ItemName \"Monitor Account Creation\" -LogType $LogType -WorkSpaceID $WorkSpaceID -WorkspaceKey $WorkspaceKey -ReportTime $ReportTime",
     "variables":
     [
       {
         "Name":"departmentnumber",
         "Value":"DepartmentNumber"
       }
     ]
  },
  {
     "ModuleName": "Verify-PBMMPolicy",
     "Script": "Verify-PBMMPolicy -ControlName $CtrName5 -ItemName \"PBMMPolicy Compliance\" -CtrName6 $CtrName6 -ItemName6 $ItemName6   -CtrName7 $CtrName7 -ItemName7 $ItemName7 -PolicyID $vars.pbmmpolicyID -LogType $LogType -WorkSpaceID $WorkSpaceID -WorkspaceKey $WorkspaceKey -ReportTime $ReportTime -CBSSubscriptionName $vars.cbssubscriptionName",
     "variables":
     [
       {
         "Name":"cbssubscriptionName",
         "Value":"CBSSubscriptionName"
       },
       {
        "Name":"pbmmpolicyID",
        "Value":"PBMMPolicyID"
      }
     ]
  },
  {
     "ModuleName": "Verify-AllowedLocationPolicy",
     "Script": "Verify-AllowedLocationPolicy -ControlName $CtrName5 -ItemName \"AllowedLocationPolicy\" -PolicyID $vars.AllowedLocationPolicyId -LogType $LogType -WorkSpaceID $WorkSpaceID -workspaceKey $workspaceKey -ReportTime $ReportTime -CBSSubscriptionName $vars.cbssubscriptionName",
     "variables":
     [
      {
        "Name":"cbssubscriptionName",
        "Value":"CBSSubscriptionName"
      },
      {
        "Name":"AllowedLocationPolicyId",
        "Value":"AllowedLocationPolicyId"
      }
     ]
  },
  {
     "ModuleName": "Get-SubnetComplianceInformation",
     "Script": "Get-SubnetComplianceInformation -ControlName $CtrName8 -WorkSpaceID $WorkSpaceID -workspaceKey $WorkspaceKey      -ReportTime $ReportTime -CBSSubscriptionName $vars.CBSSubscriptionName",
     "variables":
     [
      {
        "Name":"cbssubscriptionName",
        "Value":"CBSSubscriptionName"
      }
     ]
  },
  {
     "ModuleName": "Get-VnetComplianceInformation",
     "Script": "Get-VnetComplianceInformation -ControlName $CtrName9 -WorkSpaceID $WorkSpaceID -workspaceKey $WorkspaceKey      -ReportTime $ReportTime -CBSSubscriptionName $vars.CBSSubscriptionName",
     "variables":
     [
      {
        "Name":"cbssubscriptionName",
        "Value":"CBSSubscriptionName"
      }
     ]
  },
  {
     "ModuleName": "Check-CBSSensors",
     "Script": "Check-CBSSensors -SubscriptionName $vars.CBSSubscriptionName -TenantID $TenantID -ControlName $CtrName10 -WorkSpaceID $WorkSpaceID -workspaceKey $WorkspaceKey -ReportTime $ReportTime -LogType $LogType",
     "variables":
     [
      {
        "Name":"cbssubscriptionName",
        "Value":"CBSSubscriptionName"
      }
     ]
  },
  {
     "ModuleName": "Check-LoggingAndMonitoring",
     "Script": "Check-LoggingAndMonitoring -SecurityLAWResourceId $vars.SecurityLAWResourceId -HealthLAWResourceId $vars.HealthLAWResourceId -LogType $LogType -WorkSpaceID $WorkSpaceID -WorkspaceKey $WorkspaceKey -ControlName $CtrName11 -ReportTime $ReportTime -CBSSubscriptionName $vars.CBSSubscriptionName",
     "variables":
     [
       {
         "Name":"SecurityLAWResourceId",
         "Value":"SecurityLAWResourceId"
       },
       {
        "Name":"HealthLAWResourceId",
        "Value":"HealthLAWResourceId"
      },       
      {
        "Name":"CBSSubscriptionName",
        "Value":"CBSSubscriptionName"
      }
     ]
  },
  {
     "ModuleName": "Check-PrivateMarketPlaceCreation",
     "Script": "Check-PrivateMarketPlaceCreation -ControlName $Ctrname12 -WorkSpaceID $WorkSpaceID -workspaceKey $WorkspaceKey -ReportTime $ReportTime -LogType $LogType"
  }
]
